<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>填空题测验</title>
    <!-- 引入 Element UI 样式 -->
    <link rel="stylesheet" href="element-ui/lib/theme-chalk/index.css">
    <!-- 自定义样式 -->
    <style>
        .question-container {
            margin-bottom: 20px;
        }
        .input-container {
            margin-bottom: 10px;
        }
        .input-container el-input {
            width: 300px; /* 自定义输入框宽度 */
        }
        .submit-btn {
            background-color: #409eff; /* 按钮背景颜色 */
            color: #fff; /* 按钮文字颜色 */
        }
    </style>
</head>
<body>
<div id="app">
    <el-container>
        <el-header>
            <!-- 返回按钮 -->
            <el-button @click="goBack" type="text">返回</el-button>
        </el-header>
        <el-main>
            <h1>填空题测验</h1>
            <div v-if="questions.length > 0">
                <!-- 使用 v-for 遍历所有题目 -->
                <div v-for="(question, index) in questions" :key="question.id" class="question-container">
                    <h2>题目 {{ index + 1 }}: {{ question.question_text }}</h2>
                    <!-- 输入框用来填写答案 -->
                    <div class="input-container">
                        <el-input v-model="userAnswers[index]" placeholder="请输入答案"></el-input>
                    </div>
                </div>
                <!-- 时间输入框 -->
                <div class="input-container">
                    <el-input v-model="userTime" placeholder="请输入时间"></el-input>
                </div>
                <!-- 提交按钮 -->
                <el-button @click="submitAnswers" class="submit-btn">提交答案</el-button>
            </div>
            <div v-else>
                <h2>暂无题目</h2>
            </div>
        </el-main>
    </el-container>
</div>

<!-- 引入 Vue.js 和 Element UI JavaScript 文件 -->
<script src="js/axios-0.18.0.js"></script>
<script src="js/vue.js"></script>
<script src="element-ui/lib/index.js"></script>
<script>
    new Vue({
        el: '#app',
        data: {
            questions: [], // 存储题目列表
            userAnswers: [], // 存储用户填写的答案
            userTime: '', // 用户填写的时间
            courseId: '' // 课程ID
        },
        methods: {
            submitAnswers() {
                // 构建待提交的数据对象
                const formData = {
                    courseId: this.courseId,
                    answers: this.userAnswers,
                    time: this.userTime
                };

                // 发送用户填写的答案到服务器进行处理
                axios.post('/try2/submitAnswersServlet', formData)
                    .then(response => {
                        console.log('提交答案成功:', response.data);
                        this.$message.success('提交成功！');
                        // 在这里根据服务器返回的响应进行相应的处理
                    })
                    .catch(error => {
                        console.error('提交答案时出错:', error);
                    });
            },

            goBack() {
                window.history.back(); // 返回上一页
            },
            fetchQuestions() {
                // 在这里发送请求获取题目数据
                // 这里假设使用axios发送GET请求
                axios.get('/try2/getQuestionsServlet1', {
                    params: {
                        courseId: this.courseId // 将课程ID作为参数发送到后端
                    }
                })
                    .then(response => {
                        this.questions = response.data; // 将获取到的题目数据存储到questions中
                        // 根据题目数量初始化用户答案数组
                        this.userAnswers = new Array(response.data.length).fill('');
                    })
                    .catch(error => {
                        console.error('获取题目时出错:', error);
                    });
            }
        },
        mounted() {
            const urlParams = new URLSearchParams(window.location.search);
            this.courseId = urlParams.get('courseId');
            this.fetchQuestions(); // 页面加载时获取题目数据
        }
    });
</script>
</body>
</html>
